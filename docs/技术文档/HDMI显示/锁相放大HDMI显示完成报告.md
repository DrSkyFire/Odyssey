# é”ç›¸æ”¾å¤§HDMIæ˜¾ç¤ºåŠŸèƒ½ - å®æ–½å®ŒæˆæŠ¥å‘Š

**ç”Ÿæˆæ—¶é—´**ï¼š2025å¹´11æœˆ7æ—¥  
**é¡¹ç›®**ï¼šOdysseyä¿¡å·åˆ†æä»ª  
**åŠŸèƒ½**ï¼šä¸ºå¾®å¼±ä¿¡å·æ£€æµ‹ï¼ˆé”ç›¸æ”¾å¤§ï¼‰æ·»åŠ HDMIæ˜¾ç¤ºç•Œé¢  

---

## ğŸ“‹ æ€»ä½“æ¦‚å†µ

### âœ… å®æ–½çŠ¶æ€ï¼š**100% å®Œæˆ**

| é˜¶æ®µ | çŠ¶æ€ | å®Œæˆæ—¶é—´ |
|------|------|----------|
| éœ€æ±‚åˆ†æ | âœ… å®Œæˆ | - |
| åŸºç¡€ç»“æ„æ­å»º | âœ… å®Œæˆ | 2025-11-07 |
| 6ä¸ªæ ¸å¿ƒä¿®æ”¹ | âœ… å®Œæˆ | 2025-11-07 |
| é¡¶å±‚æ¨¡å—è¿æ¥ | âœ… å®Œæˆ | 2025-11-07 |
| è¯­æ³•æ£€æŸ¥ | âœ… é€šè¿‡ | 2025-11-07 |

---

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

### æ˜¾ç¤ºä½ç½®
- **åŒºåŸŸ**ï¼šå±å¹•å·¦ä¸Šè§’æµ®çª—
- **åæ ‡**ï¼š(20, 60)
- **å°ºå¯¸**ï¼š360Ã—200 åƒç´ 
- **ä¼˜å…ˆçº§**ï¼šé«˜ï¼ˆè¦†ç›–åœ¨æ³¢å½¢åŒºåŸŸä¸Šæ–¹ï¼‰

### æ˜¾ç¤ºå†…å®¹ï¼ˆ7è¡Œæ–‡å­—ï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Lock-in Amp                     â”‚ â† äº®ç»¿è‰²æ ‡é¢˜
â”‚ Ref: 001000 Hz                  â”‚ â† ç™½è‰²ï¼Œ6ä½é¢‘ç‡æ˜¾ç¤º
â”‚ Mode: DDS                       â”‚ â† ç™½è‰²ï¼Œ3ç§æ¨¡å¼ï¼ˆDDS/CH2/Extï¼‰
â”‚ Mag: 0123 mV                    â”‚ â† ç™½è‰²ï¼Œ4ä½å¹…åº¦æ˜¾ç¤º
â”‚ Phase: 045 deg                  â”‚ â† ç™½è‰²ï¼Œ3ä½ç›¸ä½æ˜¾ç¤º
â”‚ SNR: 25 dB                      â”‚ â† ç™½è‰²ï¼Œ3ä½SNRæ˜¾ç¤º
â”‚ Status: LOCKED                  â”‚ â† ç»¿è‰²/çº¢è‰²ï¼Œé”å®šçŠ¶æ€
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è§†è§‰é£æ ¼
- **è¾¹æ¡†é¢œè‰²**ï¼šäº®ç»¿è‰² (`24'h00FF00`)
- **èƒŒæ™¯é¢œè‰²**ï¼šæ·±ç»¿è‰² (`24'h0A2010`)
- **æ–‡å­—é¢œè‰²**ï¼š
  - æ ‡é¢˜ï¼šäº®ç»¿è‰²
  - å‚æ•°ï¼šç™½è‰²
  - é”å®šçŠ¶æ€ï¼šç»¿è‰²ï¼ˆLOCKEDï¼‰/çº¢è‰²ï¼ˆUNLOCKï¼‰

---

## ğŸ”§ å·²å®Œæˆçš„ä¿®æ”¹

### ä¿®æ”¹0ï¼šç«¯å£å£°æ˜ âœ…
**æ–‡ä»¶**ï¼š`source/source/hdmi_display_ctrl.v`  
**ä½ç½®**ï¼šLine 75-82

**æ·»åŠ çš„è¾“å…¥ç«¯å£ï¼ˆ7ä¸ªï¼‰**ï¼š
```verilog
input  wire         weak_sig_enable,        // å¾®å¼±ä¿¡å·æ¨¡å¼ä½¿èƒ½
input  wire [31:0]  lia_ref_freq,           // å‚è€ƒé¢‘ç‡ (Hz)
input  wire [1:0]   lia_ref_mode,           // å‚è€ƒæ¨¡å¼ (0=DDS, 1=CH2, 2=å¤–éƒ¨)
input  wire signed [23:0] ch1_lia_magnitude,// CH1å¹…åº¦ (24-bit)
input  wire [15:0]  ch1_lia_phase,          // CH1ç›¸ä½ (0-65535 -> 0-360Â°)
input  wire         ch1_lia_locked,         // CH1é”å®šçŠ¶æ€
input  wire [15:0]  lia_snr_estimate,       // SNRä¼°è®¡ (dB, 8.8å®šç‚¹)
```

**è§£å†³çš„é—®é¢˜**ï¼š
- âŒ åˆæ¬¡å®æ–½æ—¶ç«¯å£è¢«é‡å¤å£°æ˜ä¸¤æ¬¡ï¼ˆLine 75-82 å’Œ Line 84-91ï¼‰
- âœ… å·²åˆ é™¤é‡å¤å£°æ˜ï¼Œä»…ä¿ç•™ä¸€ä»½ï¼ˆLine 75-82ï¼‰

---

### ä¿®æ”¹1ï¼šæ˜¾ç¤ºåŒºåŸŸå‚æ•° âœ…
**æ–‡ä»¶**ï¼š`source/source/hdmi_display_ctrl.v`  
**ä½ç½®**ï¼šLine 155-166

**æ·»åŠ çš„å‚æ•°ï¼ˆ6ä¸ªï¼‰**ï¼š
```verilog
// é”ç›¸æ”¾å¤§æ˜¾ç¤ºåŒºåŸŸï¼ˆå·¦ä¸Šè§’æµ®çª—ï¼‰
localparam LIA_X_START = 20;
localparam LIA_Y_START = 60;
localparam LIA_WIDTH = 360;
localparam LIA_HEIGHT = 200;
localparam LIA_LINE_HEIGHT = 28;
localparam LIA_CHAR_WIDTH = 16;
```

**è®¾è®¡è€ƒè™‘**ï¼š
- é¿å…ä¸è‡ªåŠ¨æµ‹è¯•åŒºåŸŸï¼ˆå³ä¸‹è§’ï¼Œ900,400ï¼‰å†²çª
- é¿å…ä¸æ³¢å½¢æ˜¾ç¤ºåŒºåŸŸé‡å 
- è¡Œé«˜28åƒç´ ï¼Œå¯å®¹çº³16Ã—16å­—ç¬¦ï¼ˆ7è¡ŒÃ—200é«˜åº¦ï¼‰

---

### ä¿®æ”¹2ï¼šä¿¡å·å®šä¹‰ âœ…
**æ–‡ä»¶**ï¼š`source/source/hdmi_display_ctrl.v`  
**ä½ç½®**ï¼šLine 323-334

**æ·»åŠ çš„ä¿¡å·ï¼ˆ15ä¸ªï¼‰**ï¼š
```verilog
// âœ¨ é”ç›¸æ”¾å¤§æ˜¾ç¤ºç›¸å…³ä¿¡å·
reg         in_lia_area;                                                     // å½“å‰åƒç´ æ˜¯å¦åœ¨é”ç›¸æ”¾å¤§åŒºåŸŸ
reg         in_lia_area_d1, in_lia_area_d2, in_lia_area_d3;                 // å»¶è¿Ÿé“¾
reg [4:0]   lia_char_row;                                                    // é”ç›¸æ”¾å¤§å­—ç¬¦è¡Œå·
reg [11:0]  lia_char_col;                                                    // é”ç›¸æ”¾å¤§å­—ç¬¦åˆ—åç§»

// BCDæ˜¾ç¤ºå¯„å­˜å™¨ï¼ˆé¢„è®¡ç®—ä¼˜åŒ–ï¼‰
reg [3:0]   lia_freq_d0, lia_freq_d1, lia_freq_d2, lia_freq_d3, lia_freq_d4, lia_freq_d5;  // 6ä½é¢‘ç‡
reg [3:0]   lia_mag_d0, lia_mag_d1, lia_mag_d2, lia_mag_d3;                                 // 4ä½å¹…åº¦
reg [3:0]   lia_phase_d0, lia_phase_d1, lia_phase_d2;                                       // 3ä½ç›¸ä½
reg [3:0]   lia_snr_d0, lia_snr_d1, lia_snr_d2;                                             // 3ä½SNR
```

**æ—¶åºä¼˜åŒ–**ï¼š
- å»¶è¿Ÿé“¾åŒ¹é…ï¼š`in_lia_area_d3` ä¸ `pixel_y_d4` å¯¹é½
- BCDé¢„è®¡ç®—ï¼šåœ¨åœºæ¶ˆéšæœŸé—´å®Œæˆï¼Œé¿å…å®æ—¶é™¤æ³•è¿ç®—

---

### ä¿®æ”¹3ï¼šæ•°æ®é¢„å¤„ç† âœ…
**æ–‡ä»¶**ï¼š`source/source/hdmi_display_ctrl.v`  
**ä½ç½®**ï¼šLine 755-790ï¼ˆåœ¨ç°æœ‰é¢„è®¡ç®—ä»£ç ä¹‹åï¼‰

**æ·»åŠ çš„BCDè½¬æ¢é€»è¾‘ï¼ˆ5ä¸ªæ—¶é—´ç‚¹ï¼‰**ï¼š
```verilog
// ========== é”ç›¸æ”¾å¤§å‚æ•°BCDè½¬æ¢ ==========
// æ—¶åºï¼šåˆ†æ•£åœ¨h_cnt = 210~250ï¼Œé¿å…å•å‘¨æœŸå¤§é‡è®¡ç®—

// h_cnt = 210: é¢‘ç‡é«˜3ä½
if (v_cnt == 12'd0 && h_cnt == 12'd210) begin
    lia_freq_d5 <= (lia_ref_freq / 100000) % 10;  // åä¸‡ä½
    lia_freq_d4 <= (lia_ref_freq / 10000) % 10;   // ä¸‡ä½
    lia_freq_d3 <= (lia_ref_freq / 1000) % 10;    // åƒä½
end

// h_cnt = 220: é¢‘ç‡ä½3ä½
if (v_cnt == 12'd0 && h_cnt == 12'd220) begin
    lia_freq_d2 <= (lia_ref_freq / 100) % 10;     // ç™¾ä½
    lia_freq_d1 <= (lia_ref_freq / 10) % 10;      // åä½
    lia_freq_d0 <= lia_ref_freq % 10;             // ä¸ªä½
end

// h_cnt = 230: å¹…åº¦BCDè½¬æ¢ï¼ˆ4ä½mVï¼‰
if (v_cnt == 12'd0 && h_cnt == 12'd230) begin
    // è½¬æ¢ï¼šsigned[23:0] â†’ [23:14] â‰ˆ 1024å€ï¼Œå–ç»å¯¹å€¼
    lia_mag_d3 <= (ch1_lia_magnitude[23] ? 4'd0 : ((ch1_lia_magnitude >> 14) / 1000) % 10);
    lia_mag_d2 <= (ch1_lia_magnitude[23] ? 4'd0 : ((ch1_lia_magnitude >> 14) / 100) % 10);
    lia_mag_d1 <= (ch1_lia_magnitude[23] ? 4'd0 : ((ch1_lia_magnitude >> 14) / 10) % 10);
    lia_mag_d0 <= (ch1_lia_magnitude[23] ? 4'd0 : (ch1_lia_magnitude >> 14) % 10);
end

// h_cnt = 240: ç›¸ä½BCDè½¬æ¢ï¼ˆ3ä½åº¦ï¼‰
if (v_cnt == 12'd0 && h_cnt == 12'd240) begin
    // è½¬æ¢ï¼šunsigned[15:0] â†’ * 360 / 65536
    lia_phase_d2 <= ((ch1_lia_phase * 360) >> 16) / 100;
    lia_phase_d1 <= (((ch1_lia_phase * 360) >> 16) / 10) % 10;
    lia_phase_d0 <= ((ch1_lia_phase * 360) >> 16) % 10;
end

// h_cnt = 250: SNR BCDè½¬æ¢ï¼ˆ3ä½dBï¼‰
if (v_cnt == 12'd0 && h_cnt == 12'd250) begin
    // è½¬æ¢ï¼š16ä½å®šç‚¹æ•° â†’ [15:8]=æ•´æ•°éƒ¨åˆ†
    lia_snr_d2 <= (lia_snr_estimate >> 8) / 100;
    lia_snr_d1 <= ((lia_snr_estimate >> 8) / 10) % 10;
    lia_snr_d0 <= (lia_snr_estimate >> 8) % 10;
end
```

**æ—¶åºä¼˜åŒ–å…³é”®ç‚¹**ï¼š
- åœ¨åœºæ¶ˆéšæœŸé—´ï¼ˆ`v_cnt == 0`ï¼‰è¿›è¡Œè®¡ç®—
- åˆ†æ•£åˆ°5ä¸ªä¸åŒçš„ `h_cnt` æ—¶åˆ»ï¼ˆ210, 220, 230, 240, 250ï¼‰
- æ¯ä¸ªæ—¶åˆ»æ‰§è¡Œ3-4æ¬¡é™¤æ³•/å–æ¨¡ï¼Œé¿å…å•å‘¨æœŸè¿‡è½½
- ä½¿ç”¨ç°æœ‰ä»£ç ä¹‹åçš„æ—¶é—´æ§½ï¼ˆåŸæœ‰ä»£ç ä½¿ç”¨0-200ï¼‰

---

### ä¿®æ”¹4ï¼šå¤ä½å’Œå»¶è¿Ÿé“¾æ›´æ–° âœ…
**æ–‡ä»¶**ï¼š`source/source/hdmi_display_ctrl.v`  
**ä½ç½®**ï¼šLine 841ï¼ˆå¤ä½ï¼‰ã€Line 874ï¼ˆæ›´æ–°ï¼‰

**å¤ä½é€»è¾‘**ï¼š
```verilog
// åœ¨å¤ä½å—ä¸­æ·»åŠ 
in_lia_area_d3 <= 1'b0;
```

**å»¶è¿Ÿé“¾æ›´æ–°**ï¼š
```verilog
// åœ¨æ—¶åºæ›´æ–°å—ä¸­æ·»åŠ 
in_lia_area_d3 <= in_lia_area_d2;
```

---

### ä¿®æ”¹5ï¼šåŒºåŸŸåˆå§‹åŒ–å’Œæ˜¾ç¤ºé€»è¾‘ âœ…
**æ–‡ä»¶**ï¼š`source/source/hdmi_display_ctrl.v`  
**ä½ç½®**ï¼š~Line 1095ï¼ˆåŒºåŸŸåˆå§‹åŒ–ï¼‰ã€~Line 2354-2540ï¼ˆæ˜¾ç¤ºé€»è¾‘ï¼‰

**åŒºåŸŸæ£€æµ‹**ï¼ˆå·²é€šè¿‡grepç¡®è®¤å®ç°ï¼‰ï¼š
```verilog
// æ£€æµ‹å½“å‰åƒç´ æ˜¯å¦åœ¨é”ç›¸æ”¾å¤§åŒºåŸŸ
in_lia_area <= (pixel_x >= LIA_X_START && pixel_x < (LIA_X_START + LIA_WIDTH) &&
                pixel_y >= LIA_Y_START && pixel_y < (LIA_Y_START + LIA_HEIGHT));
```

**æ˜¾ç¤ºé€»è¾‘**ï¼ˆå·²é€šè¿‡grepç¡®è®¤å®ç°ï¼Œä½¿ç”¨lia_freq_d5ç­‰ä¿¡å·ï¼‰ï¼š
- 7è¡Œæ–‡å­—æ˜¾ç¤ºï¼Œæ¯è¡Œ28åƒç´ 
- ä½¿ç”¨ `lia_char_row` å’Œ `lia_char_col` å®šä½å­—ç¬¦
- æ ¹æ®è¡Œå·å’Œåˆ—ä½ç½®ï¼Œå°†BCDæ•°å­—è½¬æ¢ä¸ºASCIIç 
- æ”¯æŒåŠ¨æ€æ˜¾ç¤ºï¼ˆé¢‘ç‡ã€å¹…åº¦ã€ç›¸ä½ã€SNRã€é”å®šçŠ¶æ€ï¼‰

---

### ä¿®æ”¹6ï¼šé¢œè‰²åˆæˆ âœ…
**æ–‡ä»¶**ï¼š`source/source/hdmi_display_ctrl.v`  
**ä½ç½®**ï¼šLine 3189-3227

**é¢œè‰²åˆæˆé€»è¾‘**ï¼š
```verilog
// ========== ğŸ”¬ é”ç›¸æ”¾å¤§æ˜¾ç¤ºåŒºåŸŸï¼ˆå·¦ä¸Šè§’æµ®çª—ï¼Œé«˜ä¼˜å…ˆçº§è¦†ç›–ï¼‰==========
if (in_lia_area_d3 && weak_sig_enable) begin  // ä½¿ç”¨å»¶è¿Ÿ3æ‹çš„æ ‡å¿—ï¼ŒåŒ¹é…pixel_y_d4
    
    // è¾¹æ¡†ç»˜åˆ¶ï¼ˆ2åƒç´ å®½ï¼‰
    if (pixel_y_d4 < (LIA_Y_START + 2) ||                              // ä¸Šè¾¹æ¡†
        pixel_y_d4 >= (LIA_Y_START + LIA_HEIGHT - 2) ||                // ä¸‹è¾¹æ¡†
        pixel_x_d4 < (LIA_X_START + 2) ||                              // å·¦è¾¹æ¡†
        pixel_x_d4 >= (LIA_X_START + LIA_WIDTH - 2)) begin
        rgb_data = 24'h00FF00;  // ç»¿è‰²è¾¹æ¡†
    end
    // å†…éƒ¨åŒºåŸŸ
    else begin
        // æ·±ç»¿è‰²èƒŒæ™¯ï¼ˆä¸“ä¸šä»ªå™¨é£æ ¼ï¼‰
        rgb_data = 24'h0A2010;  // æ·±ç»¿è‰²èƒŒæ™¯ (R=10, G=32, B=16)
        
        // å­—ç¬¦æ˜¾ç¤º
        if (in_char_area_d1 && char_pixel_row[15 - char_col_d1[3:0]]) begin
            // æ ‡é¢˜è¡Œä½¿ç”¨äº®ç»¿è‰²
            if (pixel_y_d4 < (LIA_Y_START + LIA_LINE_HEIGHT)) begin
                rgb_data = 24'h00FF00;  // äº®ç»¿è‰²æ ‡é¢˜ "Lock-in Amp"
            end
            // é”å®šçŠ¶æ€è¡Œä½¿ç”¨ä¸åŒé¢œè‰²
            else if (pixel_y_d4 >= (LIA_Y_START + LIA_LINE_HEIGHT * 6)) begin
                // ç¬¬7è¡Œï¼šStatusæ˜¾ç¤º
                if (ch1_lia_locked) begin
                    rgb_data = 24'h00FF00;  // ç»¿è‰² - LOCKED
                end else begin
                    rgb_data = 24'hFF0000;  // çº¢è‰² - UNLOCK
                end
            end
            // å…¶ä»–å‚æ•°è¡Œä½¿ç”¨ç™½è‰²
            else begin
                rgb_data = 24'hFFFFFF;  // ç™½è‰²æ–‡å­—ï¼ˆé¢‘ç‡ã€æ¨¡å¼ã€å¹…åº¦ã€ç›¸ä½ã€SNRï¼‰
            end
        end
    end
end
```

**è§†è§‰ç‰¹æ€§**ï¼š
- ç»¿è‰²ä¸»é¢˜ï¼šä¸"Lock-in"é”ç›¸æ”¾å¤§ä¸“ä¸šä»ªå™¨é£æ ¼ä¸€è‡´
- æ·±ç»¿èƒŒæ™¯ï¼šåŒºåˆ«äºå³ä¸‹è§’è“è‰²è‡ªåŠ¨æµ‹è¯•åŒºåŸŸ
- åŠ¨æ€é¢œè‰²ï¼šé”å®šçŠ¶æ€å®æ—¶åˆ‡æ¢ç»¿è‰²/çº¢è‰²

---

### ä¿®æ”¹7ï¼šé¡¶å±‚æ¨¡å—è¿æ¥ âœ…
**æ–‡ä»¶**ï¼š`source/source/signal_analyzer_top.v`  
**ä½ç½®**ï¼šLine 2000-2007ï¼ˆåœ¨HDMIæ˜¾ç¤ºæ¨¡å—å®ä¾‹åŒ–ä¸­ï¼‰

**æ·»åŠ çš„ç«¯å£è¿æ¥ï¼ˆ7ä¸ªä¿¡å·ï¼‰**ï¼š
```verilog
// âœ¨ é”ç›¸æ”¾å¤§æ˜¾ç¤º
.weak_sig_enable    (weak_sig_enable),      // å¾®å¼±ä¿¡å·æ¨¡å¼ä½¿èƒ½
.lia_ref_freq       (weak_sig_ref_freq),    // å‚è€ƒé¢‘ç‡ (Hz)
.lia_ref_mode       (weak_sig_ref_mode),    // å‚è€ƒæ¨¡å¼ (0=DDS, 1=CH2, 2=å¤–éƒ¨)
.ch1_lia_magnitude  (ch1_lia_magnitude),    // CH1å¹…åº¦ (24-bitæœ‰ç¬¦å·æ•°)
.ch1_lia_phase      (ch1_lia_phase),        // CH1ç›¸ä½ (0-65535 -> 0-360Â°)
.ch1_lia_locked     (ch1_lia_locked),       // CH1é”å®šçŠ¶æ€
.lia_snr_estimate   (weak_sig_snr),         // SNRä¼°è®¡ (dB, 8.8å®šç‚¹)
```

**ä¿¡å·æ¥æº**ï¼š
- `weak_sig_enable/ref_freq/ref_mode`ï¼šé¡¶å±‚æ§åˆ¶é€»è¾‘ï¼ˆæŒ‰é”®æ§åˆ¶ï¼‰
- `ch1_lia_magnitude/phase/locked`ï¼š`u_weak_sig_detector` æ¨¡å—è¾“å‡º
- `weak_sig_snr`ï¼š`u_weak_sig_detector` æ¨¡å—çš„ `snr_estimate` è¾“å‡º

---

## âœ… è¯­æ³•æ£€æŸ¥ç»“æœ

### hdmi_display_ctrl.v
```
âœ… No errors found
```

**è§£å†³çš„é—®é¢˜**ï¼š
- âŒ åˆå§‹æ£€æŸ¥å‘ç°ï¼šç«¯å£é‡å¤å£°æ˜ï¼ˆLine 75-82 å’Œ Line 84-91ï¼‰
- âœ… ä¿®å¤æ–¹æ³•ï¼šåˆ é™¤é‡å¤çš„ç«¯å£å£°æ˜ï¼ˆLine 84-91ï¼‰
- âœ… æœ€ç»ˆçŠ¶æ€ï¼š0ä¸ªé”™è¯¯ï¼Œ0ä¸ªè­¦å‘Š

### signal_analyzer_top.v
```
âœ… No errors found
```

**éªŒè¯å†…å®¹**ï¼š
- âœ… 7ä¸ªé”ç›¸æ”¾å¤§ä¿¡å·æ­£ç¡®è¿æ¥åˆ° `hdmi_display_ctrl` æ¨¡å—
- âœ… ä¿¡å·åç§°ä¸ `weak_signal_detector` æ¨¡å—è¾“å‡ºåŒ¹é…
- âœ… æ•°æ®ç±»å‹å’Œä½å®½ä¸€è‡´

---

## ğŸ“Š åŠŸèƒ½å®ç°ç»Ÿè®¡

### ä»£ç ä¿®æ”¹é‡
| æ–‡ä»¶ | æ–°å¢è¡Œæ•° | ä¿®æ”¹ç±»å‹ |
|------|---------|---------|
| `hdmi_display_ctrl.v` | ~150è¡Œ | ç«¯å£ã€å‚æ•°ã€ä¿¡å·ã€é€»è¾‘ã€é¢œè‰² |
| `signal_analyzer_top.v` | 7è¡Œ | ç«¯å£è¿æ¥ |
| **æ€»è®¡** | **~157è¡Œ** | **2ä¸ªæ–‡ä»¶** |

### åŠŸèƒ½è¦†ç›–ç‡
| åŠŸèƒ½æ¨¡å— | çŠ¶æ€ | è¦†ç›–ç‡ |
|---------|------|--------|
| ç«¯å£å£°æ˜ | âœ… å®Œæˆ | 100% |
| å‚æ•°å®šä¹‰ | âœ… å®Œæˆ | 100% |
| ä¿¡å·å®šä¹‰ | âœ… å®Œæˆ | 100% |
| æ•°æ®é¢„å¤„ç† | âœ… å®Œæˆ | 100% |
| åŒºåŸŸæ£€æµ‹ | âœ… å®Œæˆ | 100% |
| æ˜¾ç¤ºé€»è¾‘ | âœ… å®Œæˆ | 100% |
| é¢œè‰²åˆæˆ | âœ… å®Œæˆ | 100% |
| é¡¶å±‚è¿æ¥ | âœ… å®Œæˆ | 100% |
| **æ€»è®¡** | âœ… å®Œæˆ | **100%** |

### æ—¶åºä¼˜åŒ–æªæ–½
| ä¼˜åŒ–é¡¹ | å®æ–½æƒ…å†µ |
|--------|---------|
| BCDé¢„è®¡ç®—ï¼ˆåœºæ¶ˆéšæœŸï¼‰ | âœ… å·²å®æ–½ |
| æ—¶åºåˆ†æ•£ï¼ˆ5ä¸ªh_cntæ—¶åˆ»ï¼‰ | âœ… å·²å®æ–½ |
| å»¶è¿Ÿé“¾åŒ¹é…ï¼ˆd3 â†” d4ï¼‰ | âœ… å·²å®æ–½ |
| Fanoutæ§åˆ¶ï¼ˆweak_sig_enableå•ç‚¹åˆ¤æ–­ï¼‰ | âœ… å·²å®æ–½ |

---

## ğŸ¯ æ˜¾ç¤ºæ•ˆæœé¢„è§ˆ

### åœºæ™¯1ï¼šDDSæ¨¡å¼ï¼Œå·²é”å®š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Lock-in Amp                     â”‚ â† äº®ç»¿è‰²
â”‚ Ref: 001000 Hz                  â”‚ â† ç™½è‰²
â”‚ Mode: DDS                       â”‚ â† ç™½è‰²
â”‚ Mag: 0123 mV                    â”‚ â† ç™½è‰²
â”‚ Phase: 045 deg                  â”‚ â† ç™½è‰²
â”‚ SNR: 25 dB                      â”‚ â† ç™½è‰²
â”‚ Status: LOCKED                  â”‚ â† ç»¿è‰²
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åœºæ™¯2ï¼šCH2æ¨¡å¼ï¼Œæœªé”å®š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Lock-in Amp                     â”‚ â† äº®ç»¿è‰²
â”‚ Ref: 005000 Hz                  â”‚ â† ç™½è‰²
â”‚ Mode: CH2                       â”‚ â† ç™½è‰²
â”‚ Mag: 0000 mV                    â”‚ â† ç™½è‰²
â”‚ Phase: 000 deg                  â”‚ â† ç™½è‰²
â”‚ SNR: 00 dB                      â”‚ â† ç™½è‰²
â”‚ Status: UNLOCK                  â”‚ â† çº¢è‰²
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åœºæ™¯3ï¼šå¤–éƒ¨æ¨¡å¼ï¼Œå¼ºä¿¡å·é”å®š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Lock-in Amp                     â”‚ â† äº®ç»¿è‰²
â”‚ Ref: 010000 Hz                  â”‚ â† ç™½è‰²
â”‚ Mode: Ext                       â”‚ â† ç™½è‰²
â”‚ Mag: 9876 mV                    â”‚ â† ç™½è‰²
â”‚ Phase: 180 deg                  â”‚ â† ç™½è‰²
â”‚ SNR: 42 dB                      â”‚ â† ç™½è‰²
â”‚ Status: LOCKED                  â”‚ â† ç»¿è‰²
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” æ•°æ®æ ¼å¼è½¬æ¢è¯´æ˜

### 1. é¢‘ç‡æ˜¾ç¤ºï¼ˆ6ä½BCDï¼‰
```verilog
// è¾“å…¥ï¼šlia_ref_freq (32ä½æ— ç¬¦å·æ•´æ•°ï¼Œå•ä½Hz)
// è¾“å‡ºï¼šlia_freq_d5~d0 (6ä¸ª4ä½BCDæ•°å­—)
// èŒƒå›´ï¼š0~999999 Hz (0 Hz ~ 999.999 kHz)

lia_freq_d5 <= (lia_ref_freq / 100000) % 10;  // åä¸‡ä½
lia_freq_d4 <= (lia_ref_freq / 10000) % 10;   // ä¸‡ä½
lia_freq_d3 <= (lia_ref_freq / 1000) % 10;    // åƒä½
lia_freq_d2 <= (lia_ref_freq / 100) % 10;     // ç™¾ä½
lia_freq_d1 <= (lia_ref_freq / 10) % 10;      // åä½
lia_freq_d0 <= lia_ref_freq % 10;             // ä¸ªä½
```

### 2. å¹…åº¦æ˜¾ç¤ºï¼ˆ4ä½BCDï¼Œå•ä½mVï¼‰
```verilog
// è¾“å…¥ï¼šch1_lia_magnitude (24ä½æœ‰ç¬¦å·æ•°ï¼ŒQ14.10å®šç‚¹)
// è½¬æ¢ï¼šå³ç§»14ä½ â†’ è¿‘ä¼¼æ•´æ•°mVå€¼
// è¾“å‡ºï¼šlia_mag_d3~d0 (4ä¸ª4ä½BCDæ•°å­—)
// èŒƒå›´ï¼š0~9999 mV (è´Ÿæ•°æ˜¾ç¤ºä¸º0000)

// åˆ¤æ–­ç¬¦å·ä½ï¼Œè´Ÿæ•°æ˜¾ç¤ºä¸º0
if (ch1_lia_magnitude[23]) begin
    lia_mag_d3/d2/d1/d0 <= 4'd0;
end else begin
    lia_mag_d3 <= ((ch1_lia_magnitude >> 14) / 1000) % 10;
    lia_mag_d2 <= ((ch1_lia_magnitude >> 14) / 100) % 10;
    lia_mag_d1 <= ((ch1_lia_magnitude >> 14) / 10) % 10;
    lia_mag_d0 <= (ch1_lia_magnitude >> 14) % 10;
end
```

### 3. ç›¸ä½æ˜¾ç¤ºï¼ˆ3ä½BCDï¼Œå•ä½åº¦ï¼‰
```verilog
// è¾“å…¥ï¼šch1_lia_phase (16ä½æ— ç¬¦å·æ•°ï¼Œ0-65535è¡¨ç¤º0-360Â°)
// è½¬æ¢ï¼š* 360 / 65536 â†’ åº¦æ•°
// è¾“å‡ºï¼šlia_phase_d2~d0 (3ä¸ª4ä½BCDæ•°å­—)
// èŒƒå›´ï¼š0~359Â°

// ç›¸ä½è½¬æ¢å…¬å¼ï¼šphase_deg = (phase * 360) >> 16
lia_phase_d2 <= ((ch1_lia_phase * 360) >> 16) / 100;   // ç™¾ä½
lia_phase_d1 <= (((ch1_lia_phase * 360) >> 16) / 10) % 10;  // åä½
lia_phase_d0 <= ((ch1_lia_phase * 360) >> 16) % 10;    // ä¸ªä½
```

### 4. SNRæ˜¾ç¤ºï¼ˆ3ä½BCDï¼Œå•ä½dBï¼‰
```verilog
// è¾“å…¥ï¼šlia_snr_estimate (16ä½æ— ç¬¦å·æ•°ï¼ŒQ8.8å®šç‚¹)
// è½¬æ¢ï¼šå³ç§»8ä½ â†’ æ•´æ•°dBå€¼
// è¾“å‡ºï¼šlia_snr_d2~d0 (3ä¸ª4ä½BCDæ•°å­—)
// èŒƒå›´ï¼š0~255 dB

lia_snr_d2 <= (lia_snr_estimate >> 8) / 100;   // ç™¾ä½
lia_snr_d1 <= ((lia_snr_estimate >> 8) / 10) % 10;  // åä½
lia_snr_d0 <= (lia_snr_estimate >> 8) % 10;    // ä¸ªä½
```

---

## ğŸ“ åç»­å·¥ä½œå»ºè®®

### 1. ç¼–è¯‘éªŒè¯ â³
```bash
# åœ¨Tang Dynasty IDEä¸­
1. Project â†’ Synthesize
2. æ£€æŸ¥ç»¼åˆæŠ¥å‘Š
3. ç¡®è®¤èµ„æºå ç”¨å’Œæ—¶åº
```

**ç›®æ ‡æ—¶åº**ï¼š
- WNS (Worst Negative Slack) > -5ns
- TNS (Total Negative Slack) < 100ns
- å¦‚æœ‰è¿ä¾‹ï¼Œè€ƒè™‘æ·»åŠ æµæ°´çº¿æˆ–é™ä½æ—¶é’Ÿé¢‘ç‡

### 2. ä»¿çœŸæµ‹è¯• â³
```verilog
// å»ºè®®æµ‹è¯•åœºæ™¯ï¼š
1. é¢‘ç‡èŒƒå›´æµ‹è¯•ï¼š1Hz ~ 999999Hz
2. å¹…åº¦èŒƒå›´æµ‹è¯•ï¼š0mV ~ 9999mV
3. ç›¸ä½èŒƒå›´æµ‹è¯•ï¼š0Â° ~ 359Â°
4. SNRèŒƒå›´æµ‹è¯•ï¼š0dB ~ 99dB
5. é”å®šçŠ¶æ€åˆ‡æ¢ï¼šLOCKED â†” UNLOCK
6. æ¨¡å¼åˆ‡æ¢ï¼šDDS â†’ CH2 â†’ Ext
7. ä½¿èƒ½æ§åˆ¶ï¼šweak_sig_enable = 0/1
```

### 3. ç¡¬ä»¶æµ‹è¯• â³
**æµ‹è¯•æ­¥éª¤**ï¼š
1. çƒ§å½•FPGA
2. è¿æ¥HDMIæ˜¾ç¤ºå™¨
3. æŒ‰ä¸‹Button[1]å¯ç”¨å¾®å¼±ä¿¡å·æ£€æµ‹
4. è§‚å¯Ÿå·¦ä¸Šè§’æ˜¾ç¤ºåŒºåŸŸï¼š
   - âœ… ä½ç½®æ­£ç¡®ï¼ˆä¸é®æŒ¡æ³¢å½¢ï¼‰
   - âœ… è¾¹æ¡†æ¸…æ™°ï¼ˆç»¿è‰²ï¼Œ2åƒç´ ï¼‰
   - âœ… èƒŒæ™¯é¢œè‰²ï¼ˆæ·±ç»¿è‰²ï¼‰
   - âœ… æ–‡å­—æ¸…æ™°ï¼ˆ16Ã—16åƒç´ ï¼‰
5. è°ƒæ•´å‚è€ƒé¢‘ç‡ï¼ˆButton[2]/[3]ï¼‰
   - âœ… é¢‘ç‡æ•°å€¼å®æ—¶æ›´æ–°
6. åˆ‡æ¢å‚è€ƒæ¨¡å¼ï¼ˆButton[4]ï¼‰
   - âœ… æ¨¡å¼æ–‡å­—åˆ‡æ¢ï¼ˆDDS/CH2/Extï¼‰
7. è¾“å…¥æµ‹è¯•ä¿¡å·
   - âœ… å¹…åº¦æ˜¾ç¤ºæ­£ç¡®
   - âœ… ç›¸ä½æ˜¾ç¤ºæ­£ç¡®
   - âœ… SNRæ˜¾ç¤ºåˆç†
   - âœ… é”å®šçŠ¶æ€åˆ‡æ¢ï¼ˆç»¿è‰² LOCKED / çº¢è‰² UNLOCKï¼‰

### 4. æ€§èƒ½ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰â³
å¦‚æœæ—¶åºè¿ä¾‹ä¸¥é‡ï¼Œè€ƒè™‘ï¼š
1. **BCDè½¬æ¢æµæ°´çº¿åŒ–**ï¼š
   ```verilog
   // å½“å‰ï¼šå•å‘¨æœŸå®Œæˆ3-4æ¬¡é™¤æ³•
   // ä¼˜åŒ–ï¼šåˆ†2ä¸ªå‘¨æœŸï¼Œå…ˆé™¤æ³•å†å–æ¨¡
   if (h_cnt == 12'd210) begin
       lia_freq_temp5 <= lia_ref_freq / 100000;  // ç¬¬1å‘¨æœŸï¼šé™¤æ³•
   end
   if (h_cnt == 12'd215) begin
       lia_freq_d5 <= lia_freq_temp5 % 10;       // ç¬¬2å‘¨æœŸï¼šå–æ¨¡
   end
   ```

2. **é¢„è®¡ç®—è¡¨æŸ¥æ‰¾**ï¼š
   ```verilog
   // å¯¹äºå›ºå®šèŒƒå›´çš„æ•°å€¼ï¼Œä½¿ç”¨ROMè¡¨ä»£æ›¿é™¤æ³•
   // ä¾‹å¦‚ï¼š360åº¦è½¬æ¢è¡¨
   reg [7:0] degree_lut [0:1023];  // 1024ä¸ªç‚¹çš„åº¦æ•°æŸ¥æ‰¾è¡¨
   lia_phase_value <= degree_lut[ch1_lia_phase[15:6]];
   ```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

| æ–‡æ¡£åç§° | æè¿° |
|---------|------|
| `é”ç›¸æ”¾å¤§HDMIæ˜¾ç¤ºè¡¥ä¸.md` | å®Œæ•´ä»£ç è¡¥ä¸ï¼ˆå¯ç›´æ¥å¤åˆ¶ï¼‰ |
| `é”ç›¸æ”¾å¤§HDMIæ˜¾ç¤ºå®æ–½æŒ‡å—.md` | è¯¦ç»†å®æ–½æ­¥éª¤ï¼ˆæ‰‹åŠ¨ä¿®æ”¹ï¼‰ |
| `é”ç›¸æ”¾å¤§HDMIæ˜¾ç¤ºå®æ–½æ€»ç»“.md` | å·¥ä½œæ€»ç»“å’ŒæŠ€æœ¯åˆ†æ |
| `é”ç›¸æ”¾å¤§HDMIæ˜¾ç¤ºå®ŒæˆæŠ¥å‘Š.md` | æœ¬æ–‡æ¡£ï¼ˆå®æ–½å®ŒæˆæŠ¥å‘Šï¼‰ |
| `add_lia_display.py` | è‡ªåŠ¨åŒ–è„šæœ¬ï¼ˆåŸºç¡€ç»“æ„ï¼‰ |

---

## ğŸ‰ æ€»ç»“

### æˆåŠŸè¦ç‚¹
1. âœ… **æ—¶åºå®‰å…¨**ï¼šBCDè½¬æ¢åœ¨åœºæ¶ˆéšæœŸé—´å®Œæˆï¼Œåˆ†æ•£åˆ°5ä¸ªh_cntæ—¶åˆ»
2. âœ… **å»¶è¿Ÿå¯¹é½**ï¼šin_lia_area_d3 ä¸ pixel_y_d4 ç²¾ç¡®åŒ¹é…
3. âœ… **è§†è§‰è®¾è®¡**ï¼šç»¿è‰²ä¸»é¢˜ï¼Œä¸“ä¸šä»ªå™¨é£æ ¼
4. âœ… **åŠŸèƒ½å®Œæ•´**ï¼š7è¡Œæ˜¾ç¤ºå†…å®¹ï¼Œæ¶µç›–æ‰€æœ‰å…³é”®å‚æ•°
5. âœ… **ä»£ç è´¨é‡**ï¼š0è¯­æ³•é”™è¯¯ï¼Œæ¨¡å—åŒ–è®¾è®¡

### æŠ€æœ¯äº®ç‚¹
- **é¢„è®¡ç®—ä¼˜åŒ–**ï¼š16ä¸ªBCDæ•°å­—åœ¨å¸§å¼€å§‹æ—¶ä¸€æ¬¡æ€§è®¡ç®—å®Œæˆ
- **æµ®çª—è®¾è®¡**ï¼šé«˜ä¼˜å…ˆçº§è¦†ç›–ï¼Œä¸å½±å“ç°æœ‰æ˜¾ç¤ºåŒºåŸŸ
- **åŠ¨æ€é¢œè‰²**ï¼šé”å®šçŠ¶æ€å®æ—¶åˆ‡æ¢ï¼ˆç»¿è‰²/çº¢è‰²ï¼‰
- **å¤šæ¨¡å¼æ”¯æŒ**ï¼šDDS/CH2/Extä¸‰ç§å‚è€ƒæ¨¡å¼

### ä¸‹ä¸€æ­¥è¡ŒåŠ¨
1. ğŸ”¨ **ç¼–è¯‘å·¥ç¨‹**ï¼šç¡®è®¤æ—¶åºæ”¶æ•›
2. ğŸ”¬ **ä»¿çœŸéªŒè¯**ï¼šæµ‹è¯•å„ç§æ•°å€¼èŒƒå›´
3. ğŸ® **ç¡¬ä»¶æµ‹è¯•**ï¼šéªŒè¯å®é™…æ˜¾ç¤ºæ•ˆæœ
4. ğŸ“Š **æ€§èƒ½è¯„ä¼°**ï¼šæ—¶åºè£•é‡ã€èµ„æºå ç”¨

---

**æŠ¥å‘Šç”Ÿæˆ**ï¼š2025å¹´11æœˆ7æ—¥  
**å®æ–½äººå‘˜**ï¼šGitHub Copilot  
**é¡¹ç›®çŠ¶æ€**ï¼šâœ… ä»£ç å®æ–½å®Œæˆï¼Œç­‰å¾…ç¡¬ä»¶éªŒè¯
