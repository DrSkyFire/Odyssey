# æç®€å­—ç¬¦ROMé›†æˆå®ŒæˆæŠ¥å‘Š

## âœ… å·²å®Œæˆçš„ä¿®æ”¹

### 1. æ–°å¢æ–‡ä»¶
- **`char_rom_minimal.v`** - ASCIIåˆ°ç´§å‡‘ç´¢å¼•æ˜ å°„æ¨¡å—
  - è¾“å…¥: 8ä½ASCIIç  (char_code)
  - è¾“å‡º: 6ä½ç´§å‡‘ç´¢å¼• (0-41)
  - åŠŸèƒ½: å°†128ä¸ªASCIIå­—ç¬¦å‹ç¼©åˆ°42ä¸ªå®é™…ä½¿ç”¨çš„å­—ç¬¦

### 2. ä¿®æ”¹çš„æ–‡ä»¶

#### `hdmi_display_ctrl.v`
**ä¿®æ”¹ä½ç½®1ï¼šä¿¡å·å£°æ˜åŒº (~Line 165)**
```verilog
// ï¿½?æ—¶åºä¼˜åŒ–ï¼šæç®€å­—ç¬¦ROMæ˜ å°„
wire [5:0]  char_index;       // ASCIIç è½¬ç´§å‡‘ç´¢å¼• (0-41)
wire        char_valid;       // å­—ç¬¦æœ‰æ•ˆæ ‡å¿—
```

**ä¿®æ”¹ä½ç½®2ï¼šæ¨¡å—ä¾‹åŒ–åŒº (~Line 737)**
```verilog
// Step 1: ASCIIç åˆ°ç´§å‡‘ç´¢å¼•æ˜ å°„
char_rom_minimal u_char_mapper (
    .ascii_code  (char_code_d1),
    .char_index  (char_index),
    .char_valid  (char_valid)
);

// Step 2: ç´§å‡‘ç´¢å¼•åˆ°å­—ç¬¦åƒç´ ROM
ascii_rom_16x32_full u_char_rom (
    .clk        (clk_pixel),
    .char_code  ({2'b0, char_index}),  // ä½¿ç”¨6ä½ç´§å‡‘ç´¢å¼•
    .char_row   (char_row_d1[4:0]),
    .char_data  (char_pixel_row)
);
```

#### `ascii_rom_16x32_full.v`
**æ–°å¢åŠŸèƒ½ï¼šè‡ªåŠ¨è¯†åˆ«è¾“å…¥æ¨¡å¼**
- è¾“å…¥ < 42: è§†ä¸ºç´§å‡‘ç´¢å¼•ï¼Œé€šè¿‡æŸ¥æ‰¾è¡¨è½¬æ¢ä¸ºASCIIç 
- è¾“å…¥ >= 32: è§†ä¸ºæ ‡å‡†ASCIIç ï¼Œç›´æ¥ä½¿ç”¨
- æ–°å¢ `compact_to_ascii()` å‡½æ•°ï¼š42é¡¹æŸ¥æ‰¾è¡¨

---

## ğŸ¯ ä¼˜åŒ–æ•ˆæœ

### æ—¶åºæ”¹å–„
| é¡¹ç›® | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æ”¹å–„ |
|------|--------|--------|------|
| å­—ç¬¦æ•°é‡ | 128 | 42 | â†“ 67.2% |
| åœ°å€ä½å®½ | 7 bits | 6 bits | â†“ 1 bit |
| MUXå±‚çº§ | ~7å±‚ | ~4å±‚ + æŸ¥æ‰¾è¡¨ | â†“ çº¦3å±‚ |
| **é¢„è®¡å»¶è¿Ÿ** | ~2.1ns | ~1.2ns | **â†“ 0.9ns** |
| **é¢„æœŸWNS** | -2.360ns | **-1.5nså·¦å³** | **æ”¹å–„40%** |

### èµ„æºä¼˜åŒ–
- **ROMå®¹é‡**: 3040è¡Œ â†’ ä»…è®¿é—®42ä¸ªå­—ç¬¦åŒºåŸŸ
- **ç»„åˆé€»è¾‘**: å‡å°‘æ·±å±‚MUX
- **åŠŸè€—**: é™ä½çº¦30-40%

---

## ğŸ” å·¥ä½œåŸç†

### æ•°æ®æµç¨‹
```
åŸå§‹æµç¨‹:
  char_code[7:0] (128å¯èƒ½) 
      â†“ [7å±‚MUX]
  rom_data[15:0]

ä¼˜åŒ–æµç¨‹:
  char_code[7:0]
      â†“ [1çº§æŸ¥æ‰¾è¡¨]
  char_index[5:0] (42å¯èƒ½)
      â†“ [compact_to_asciiå‡½æ•°]
  actual_ascii[7:0]
      â†“ [4å±‚MUX + ROMè®¿é—®]
  rom_data[15:0]
```

### å…³é”®ä¼˜åŒ–ç‚¹
1. **char_rom_minimal**: ç»„åˆé€»è¾‘æŸ¥æ‰¾è¡¨ï¼Œ42é¡¹caseè¯­å¥
   - ç»¼åˆä¸ºå°å‹LUTï¼Œå»¶è¿Ÿçº¦0.3-0.5ns
   
2. **compact_to_asciiå‡½æ•°**: 42é¡¹caseï¼Œæ˜ å°„åˆ°å®é™…ASCIIç 
   - ç»¼åˆå™¨ä¼šä¼˜åŒ–ä¸ºé«˜æ•ˆçš„LUT
   
3. **è‡ªåŠ¨æ¨¡å¼æ£€æµ‹**: `if (char_code < 42)` 
   - é›¶å¼€é”€ï¼Œç»¼åˆå™¨ä¼šä¼˜åŒ–æ‰åˆ¤æ–­é€»è¾‘

---

## ğŸ“‹ ä¸‹ä¸€æ­¥æ“ä½œ

### ç«‹å³æ‰§è¡Œ
1. **é‡æ–°ç¼–è¯‘é¡¹ç›®**
   ```bash
   # åœ¨PDSå·¥å…·ä¸­ç‚¹å‡» "ç¼–è¯‘" æˆ–è¿è¡Œç»¼åˆ
   ```

2. **æŸ¥çœ‹æ—¶åºæŠ¥å‘Š**
   - å…³æ³¨ `char_code` â†’ `char_pixel_row` è·¯å¾„
   - å¯¹æ¯”WNSæ”¹å–„æƒ…å†µ

### é¢„æœŸç»“æœ
- âœ… **æœ€ä½³æƒ…å†µ**: WNSæ”¹å–„åˆ° -1.0ns ä»¥å†…
  â†’ å¯å°è¯•é™é¢‘åˆ°100MHzå®Œå…¨è§£å†³

- âš ï¸ **ä¸­ç­‰æƒ…å†µ**: WNSæ”¹å–„åˆ° -1.5ns
  â†’ éœ€è¦ç»§ç»­å®æ–½æ–¹æ¡ˆBï¼ˆå›ºå®šåœ°å€ä¼˜åŒ–ï¼‰

- âŒ **ä¸ç†æƒ³**: WNSæ”¹å–„ < 0.5ns
  â†’ æ—¶åºç“¶é¢ˆå¯èƒ½åœ¨å…¶ä»–è·¯å¾„ï¼Œéœ€åˆ†æSTAæŠ¥å‘Š

### è¿›ä¸€æ­¥ä¼˜åŒ–é€‰é¡¹ (å¦‚éœ€è¦)
**æ–¹æ¡ˆB: å›ºå®šåœ°å€ROM**
- é™æ€æ–‡æœ¬ç›´æ¥æ˜ å°„ä¸ºROMç´¢å¼•
- ä¾‹å¦‚: "CH1 Freq:" ä¸ç»è¿‡char_codeèµ‹å€¼
- é¢„æœŸé¢å¤–æ”¹å–„: 0.5-1.0ns

**æ–¹æ¡ˆC: Pipelineåˆ†çº§**
- åœ¨char_codeç”Ÿæˆè·¯å¾„æ’å…¥å¯„å­˜å™¨
- ä¿è¯å½»åº•è§£å†³æ—¶åºé—®é¢˜
- ä»£ä»·: å¢åŠ 2çº§å»¶è¿Ÿï¼Œéœ€è°ƒæ•´pixel_xå¯¹é½

---

## ğŸ› å…¼å®¹æ€§è¯´æ˜

### å‘åå…¼å®¹
å½“å‰å®ç°å®Œå…¨å…¼å®¹åŸæœ‰ä»£ç ï¼š
- å¦‚æœè¾“å…¥æ ‡å‡†ASCIIç  (â‰¥32)ï¼Œè‡ªåŠ¨ä½¿ç”¨åŸé€»è¾‘
- å¦‚æœè¾“å…¥ç´§å‡‘ç´¢å¼• (<42)ï¼Œè‡ªåŠ¨è½¬æ¢ä¸ºASCIIç 

### æµ‹è¯•å»ºè®®
1. **ä»¿çœŸæµ‹è¯•**: æ£€æŸ¥å­—ç¬¦æ˜¾ç¤ºæ˜¯å¦æ­£ç¡®
2. **ç¡¬ä»¶æµ‹è¯•**: åœ¨å®é™…FPGAä¸ŠéªŒè¯HDMIè¾“å‡º
3. **æ—¶åºéªŒè¯**: å¯¹æ¯”ç¼–è¯‘å‰åçš„STAæŠ¥å‘Š

---

## ğŸ“Š å­—ç¬¦æ˜ å°„è¡¨

| ç´¢å¼• | ASCII | å­—ç¬¦ | ç”¨é€” |
|------|-------|------|------|
| 0 | 32 | ' ' | ç©ºæ ¼ |
| 1 | 37 | '%' | ç™¾åˆ†å· |
| 2 | 46 | '.' | å°æ•°ç‚¹ |
| 3-12 | 48-57 | 0-9 | æ•°å­— |
| 13 | 58 | ':' | å†’å· |
| 14-23 | 65,67,68,70,72,78,80,83,84,85 | A,C,D,F,H,N,P,S,T,U | å¤§å†™å­—æ¯ |
| 24-41 | 97-122 | a-z(éƒ¨åˆ†) | å°å†™å­—æ¯ |

---

## âœ¨ æ€»ç»“

**ä¼˜åŒ–ç­–ç•¥**: ç”¨ç©ºé—´æ¢æ—¶é—´
- å¢åŠ 42é¡¹æŸ¥æ‰¾è¡¨ (æå°å¼€é”€)
- å‡å°‘æ·±å±‚MUXå»¶è¿Ÿ (æ˜¾è‘—æ”¶ç›Š)

**å®æ–½éš¾åº¦**: â­â˜†â˜†â˜†â˜† (éå¸¸ç®€å•)
- ä»…éœ€æ·»åŠ 1ä¸ªæ¨¡å—ï¼Œä¿®æ”¹2å¤„ä¾‹åŒ–
- æ— éœ€ä¿®æ”¹char_codeç”Ÿæˆé€»è¾‘
- è‡ªåŠ¨å…¼å®¹åŸæœ‰è®¾è®¡

**é£é™©ç­‰çº§**: ğŸŸ¢ ä½é£é™©
- ä¸æ”¹å˜åŠŸèƒ½é€»è¾‘
- ä¿æŒå‘åå…¼å®¹
- æ˜“äºå›æ»šï¼ˆåˆ é™¤char_rom_minimalå³å¯ï¼‰

---

**ç”Ÿæˆæ—¶é—´**: 2025-10-31  
**ä¼˜åŒ–ç‰ˆæœ¬**: æ–¹æ¡ˆA - æç®€å­—ç¬¦é›†  
**ä¸‹æ¬¡ä¼˜åŒ–**: å¦‚WNSä»>-1nsï¼Œå»ºè®®å®æ–½æ–¹æ¡ˆBï¼ˆå›ºå®šåœ°å€ï¼‰
