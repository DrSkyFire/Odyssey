# ç´«å…‰åŒåˆ› - Char Map ROM IPæ ¸é…ç½®é€ŸæŸ¥

## ğŸ¯ å¿«é€Ÿé…ç½®æ­¥éª¤

### Step 1: æ‰“å¼€IP Catalog
```
Pango Design Suite â†’ Tools â†’ IP Catalog
```

### Step 2: é€‰æ‹©ROM IP
```
IP Catalog å¯¼èˆªæ ‘:
â”œâ”€â”€ Memory
â”‚   â”œâ”€â”€ Distributed RAM
â”‚   â”‚   â””â”€â”€ Distributed ROM (1.4)  â† å¯é€‰ï¼Œå°å®¹é‡
â”‚   â””â”€â”€ DRM
â”‚       â””â”€â”€ DRM Based ROM (1.7)    â† æ¨èï¼Œæ”¯æŒæµæ°´çº¿
```

**æ¨è**: ä½¿ç”¨ **DRM Based ROM (1.7)**ï¼ˆæ”¯æŒè¾“å‡ºå¯„å­˜å™¨ï¼Œæ—¶åºæ›´å¥½ï¼‰

### Step 3: IPæ ¸å‚æ•°é…ç½®

#### ğŸ“‹ åŸºæœ¬å‚æ•° (General)
| å‚æ•° | å€¼ | è¯´æ˜ |
|------|---|------|
| IP Core Name | `char_map_rom` | IPæ ¸å®ä¾‹å |
| Data Width | `8` | 8ä½æ•°æ®ï¼ˆASCIIç ï¼‰ |
| Address Width | `10` | 10ä½åœ°å€ï¼ˆ1024æ·±åº¦ï¼‰ |
| Memory Depth | `1024` | è‡ªåŠ¨è®¡ç®— 2^10=1024 |

#### ğŸ“‹ åˆå§‹åŒ–è®¾ç½® (Initialization)
| å‚æ•° | å€¼ | è¯´æ˜ |
|------|---|------|
| Memory Initialization | â˜‘ï¸ Enable | ä½¿ç”¨åˆå§‹åŒ–æ–‡ä»¶ |
| Initialization File | `E:\Odyssey_proj\char_map_rom.dat` | DATæ ¼å¼ |
| File Format | `DAT` æˆ– `MIF` | æ ¹æ®PDSç‰ˆæœ¬é€‰æ‹© |

**æ–‡ä»¶æ ¼å¼è¯´æ˜**:
- **DATæ ¼å¼**: ç´«å…‰åŒåˆ›æ ‡å‡†æ ¼å¼ï¼Œåå…­è¿›åˆ¶ï¼Œæ¯è¡Œä¸€ä¸ªå­—èŠ‚
  ```
  ç¤ºä¾‹å†…å®¹ (char_map_rom.dat):
  31  â† ASCII '1' = 0x31
  30  â† ASCII '0' = 0x30
  30  â† ASCII '0' = 0x30
  20  â† ASCII ' ' = 0x20 (ç©ºæ ¼)
  ...
  ```

- **MIFæ ¼å¼**: é€šç”¨æ ¼å¼ï¼Œå¸¦åœ°å€ç´¢å¼•
  ```
  ç¤ºä¾‹å†…å®¹ (char_map_rom.mif):
  WIDTH=8;
  DEPTH=1024;
  ...
  CONTENT BEGIN
    000 : 31;
    001 : 30;
    002 : 30;
    ...
  END;
  ```

#### ğŸ“‹ æµæ°´çº¿ä¼˜åŒ– (Pipeline)
| å‚æ•° | å€¼ | è¯´æ˜ |
|------|---|------|
| Output Register | â˜‘ï¸ Enable | **å…³é”®ï¼**æ’å…¥è¾“å‡ºå¯„å­˜å™¨ |
| Register Stages | `1` | 1çº§æµæ°´çº¿ |
| Register Type | `Auto` | è‡ªåŠ¨é€‰æ‹© |

âš ï¸ **é‡è¦**: å¿…é¡»å¯ç”¨Output Registerï¼Œæ‰èƒ½æœ‰æ•ˆæ”¹å–„æ—¶åºï¼

#### ğŸ“‹ æ¥å£è®¾ç½® (Interface)
| å‚æ•° | å€¼ | è¯´æ˜ |
|------|---|------|
| Clock Enable | â˜ Disable | ROMä¸éœ€è¦CE |
| Reset | â˜ Disable | ROMä¸éœ€è¦å¤ä½ |
| Byte Write Enable | â˜ Disable | åªè¯»ROM |

### Step 4: ç”ŸæˆIPæ ¸

1. **ç‚¹å‡»GenerateæŒ‰é’®**
2. **é€‰æ‹©ç”Ÿæˆè·¯å¾„**: `ipcore/char_map_rom/`
3. **ç­‰å¾…ç”Ÿæˆå®Œæˆ** (~10ç§’)

#### éªŒè¯ç”Ÿæˆæ–‡ä»¶
```
ipcore/char_map_rom/
â”œâ”€â”€ char_map_rom.v           â† IPæ ¸é¡¶å±‚ï¼ˆç”¨äºå®ä¾‹åŒ–ï¼‰
â”œâ”€â”€ char_map_rom.idf         â† IPå®šä¹‰æ–‡ä»¶
â”œâ”€â”€ char_map_rom.xml         â† é…ç½®æ–‡ä»¶
â”œâ”€â”€ char_map_rom_tmpl.v      â† å®ä¾‹åŒ–æ¨¡æ¿
â””â”€â”€ rtl/
    â””â”€â”€ ipml_drmrom_v1_7.v   â† åº•å±‚å®ç°
```

### Step 5: æŸ¥çœ‹ç«¯å£å®šä¹‰

æ‰“å¼€ `char_map_rom.v` æŸ¥çœ‹æ¥å£ï¼š

```verilog
module char_map_rom (
    input  [9:0]  addr,   // åœ°å€è¾“å…¥ (10ä½)
    input         clk,    // æ—¶é’Ÿè¾“å…¥
    input         rst,    // å¤ä½ï¼ˆé€šå¸¸æ¥1'b0ï¼‰
    input         ce,     // ç‰‡é€‰ï¼ˆé€šå¸¸æ¥1'b1ï¼‰
    input         oce,    // è¾“å‡ºæ—¶é’Ÿä½¿èƒ½ï¼ˆé€šå¸¸æ¥1'b1ï¼‰
    output [7:0]  dout    // æ•°æ®è¾“å‡º (8ä½ASCII)
);
```

## ğŸ”§ åœ¨hdmi_display_ctrl.vä¸­å®ä¾‹åŒ–

```verilog
//=============================================================================
// å­—ç¬¦æ˜ å°„ROM IPæ ¸å®ä¾‹åŒ–
//=============================================================================
wire [9:0] char_map_addr;
wire [7:0] char_code_static;

char_map_rom u_char_map_rom (
    .addr   (char_map_addr),     // 10ä½åœ°å€
    .clk    (clk_pixel),         // HDMIåƒç´ æ—¶é’Ÿ
    .rst    (1'b0),              // ä¸éœ€è¦å¤ä½
    .ce     (1'b1),              // å§‹ç»ˆä½¿èƒ½
    .oce    (1'b1),              // è¾“å‡ºæ—¶é’Ÿä½¿èƒ½
    .dout   (char_code_static)   // 8ä½ASCIIç è¾“å‡º
);
```

## âš ï¸ å¸¸è§é—®é¢˜

### é—®é¢˜1: æ‰¾ä¸åˆ°DAT/MIFæ–‡ä»¶é€‰é¡¹
**è§£å†³**: 
- æ£€æŸ¥PDSç‰ˆæœ¬ï¼ˆéœ€2022.1åŠä»¥ä¸Šï¼‰
- å°è¯•æ‰‹åŠ¨è¾“å…¥æ–‡ä»¶è·¯å¾„
- æˆ–åœ¨IPç”Ÿæˆåæ‰‹åŠ¨ç¼–è¾‘`.idf`æ–‡ä»¶æŒ‡å®šåˆå§‹åŒ–æ–‡ä»¶

### é—®é¢˜2: ç”Ÿæˆçš„ROMæ²¡æœ‰è¾“å‡ºå¯„å­˜å™¨
**åŸå› **: Output Registeræœªå‹¾é€‰  
**å½±å“**: æ—¶åºä¼˜åŒ–æ•ˆæœå¤§æ‰“æŠ˜æ‰£  
**è§£å†³**: é‡æ–°é…ç½®IPæ ¸ï¼Œç¡®ä¿Output Register=Enable

### é—®é¢˜3: ROMæ•°æ®å…¨æ˜¯0
**åŸå› **: åˆå§‹åŒ–æ–‡ä»¶è·¯å¾„é”™è¯¯æˆ–æ ¼å¼ä¸å¯¹  
**è§£å†³**: 
1. ä½¿ç”¨ç»å¯¹è·¯å¾„: `E:\Odyssey_proj\char_map_rom.dat`
2. ç¡®ä¿æ–‡ä»¶å­˜åœ¨ä¸”æ ¼å¼æ­£ç¡®
3. é‡æ–°ç”ŸæˆIPæ ¸

### é—®é¢˜4: ç«¯å£ä¿¡å·åä¸åŒ¹é…
**åŸå› **: ä¸åŒç‰ˆæœ¬çš„IPæ ¸ç«¯å£åå¯èƒ½ä¸åŒ  
**è§£å†³**: æŸ¥çœ‹ç”Ÿæˆçš„`char_map_rom_tmpl.v`æ¨¡æ¿æ–‡ä»¶

## ğŸ“Š èµ„æºå ç”¨ä¼°ç®—

ä½¿ç”¨ **DRM Based ROM (1.7)**:
- **DRM**: çº¦1KB (1024 Ã— 8bits)
- **LUT**: ~0 (çº¯ROMï¼Œä¸å ç”¨LUT)
- **REG**: 8ä¸ª (è¾“å‡ºå¯„å­˜å™¨)

ä½¿ç”¨ **Distributed ROM (1.4)**:
- **LUT**: ~256ä¸ª (ç”¨LUTå®ç°ROM)
- **REG**: 0æˆ–8ä¸ª (å–å†³äºæ˜¯å¦æœ‰è¾“å‡ºå¯„å­˜å™¨)

**æ¨è**: DRM Based ROMï¼Œèµ„æºå ç”¨æ›´ä¼˜ã€‚

## âœ… é…ç½®æ£€æŸ¥æ¸…å•

é…ç½®å®Œæˆåæ£€æŸ¥ï¼š
- [ ] Data Width = 8
- [ ] Address Width = 10
- [ ] Memory Depth = 1024
- [ ] Initialization File å·²é€‰æ‹© (char_map_rom.dat)
- [ ] Memory Initialization = Enable
- [ ] Output Register = Enable â­ **å…³é”®**
- [ ] ç”Ÿæˆè·¯å¾„: ipcore/char_map_rom/
- [ ] éªŒè¯ç”Ÿæˆæ–‡ä»¶å­˜åœ¨

## ğŸš€ ä¸‹ä¸€æ­¥

IPæ ¸ç”Ÿæˆå®Œæˆåï¼š
1. åœ¨Pangoé¡¹ç›®ä¸­æ·»åŠ IPæ ¸åˆ°è®¾è®¡
2. æŒ‰ç…§`å­—ç¬¦æ˜ å°„ROMé›†æˆæŒ‡å—.md`ä¿®æ”¹hdmi_display_ctrl.v
3. é‡æ–°ç»¼åˆéªŒè¯æ—¶åº

---

**æ›´æ–°æ—¶é—´**: 2025-10-30  
**é€‚ç”¨PDSç‰ˆæœ¬**: 2022.1åŠä»¥ä¸Š  
**æµ‹è¯•FPGA**: ç´«å…‰åŒåˆ›PGL50H
